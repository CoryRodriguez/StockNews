---
phase: 05-frontend-bot-dashboard
plan: "05-05"
type: execute
wave: 4
depends_on:
  - "05-01"
  - "05-02"
  - "05-03"
  - "05-04"
autonomous: false
requirements:
  - UI-01
  - UI-02
  - UI-03
  - UI-04
  - UI-05
  - UI-06
  - UI-07

must_haves:
  truths:
    - "Backend tsc --noEmit passes with zero errors"
    - "Frontend tsc --noEmit passes with zero errors"
    - "All 7 backend bot routes exist (start/pause/resume/stop/status/config/positions/trades/signals)"
    - "Bot channel subscribed in useSocket.ts"
    - "BotPanel renders without crashing in the dashboard"
    - "All 4 tabs are navigable"
    - "Human confirms panel looks correct in browser"
  artifacts:
    - .planning/phases/05-frontend-bot-dashboard/05-05-SUMMARY.md
  key_links:
    - "Phase 5 complete → all UI-01 through UI-07 requirements delivered"
---

<objective>
Run automated verification checks across the full Phase 5 deliverables and present the completed Bot Panel to the user for visual confirmation.

Purpose: Catch any integration gaps before marking Phase 5 complete. The automated checks verify TypeScript compilation, route existence, and wiring patterns. The human checkpoint confirms the visual result matches expectations.

Output:
- All automated checks pass
- Human approves the Bot Panel UI
- 05-05-SUMMARY.md created
</objective>

<execution_context>
@C:/Users/Owner/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Owner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/05-frontend-bot-dashboard/05-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run automated verification suite</name>
  <files>.planning/phases/05-frontend-bot-dashboard/phase05-checks.sh</files>
  <action>
Create and run `phase05-checks.sh` in `.planning/phases/05-frontend-bot-dashboard/`. The script checks all Phase 5 deliverables:

```bash
#!/usr/bin/env bash
set -e
PASS=0; FAIL=0

check() {
  local desc="$1"; local cmd="$2"
  if eval "$cmd" > /dev/null 2>&1; then
    echo "PASS: $desc"; PASS=$((PASS+1))
  else
    echo "FAIL: $desc"; FAIL=$((FAIL+1))
  fi
}

echo "=== Phase 5 Verification ==="
cd C:/Projects/StockNews

# TypeScript
check "Backend tsc passes"  "cd backend && npx tsc --noEmit 2>&1 | grep -v '^$' | wc -l | awk '{exit \$1>0}'"
check "Frontend tsc passes" "cd frontend && npx tsc --noEmit 2>&1 | grep -v '^$' | wc -l | awk '{exit \$1>0}'"

# Backend routes
check "GET /config route exists"    "grep -q \"router.get('/config'\" backend/src/routes/bot.ts"
check "PATCH /config route exists"  "grep -q \"router.patch('/config'\" backend/src/routes/bot.ts"
check "GET /positions route exists" "grep -q \"router.get('/positions'\" backend/src/routes/bot.ts"
check "GET /trades route exists"    "grep -q \"router.get('/trades'\" backend/src/routes/bot.ts"
check "GET /signals route exists"   "grep -q \"router.get('/signals'\" backend/src/routes/bot.ts"
check "dayTradeCount in /status"    "grep -q 'dayTradeCount' backend/src/routes/bot.ts"

# WebSocket broadcasts
check "broadcast in botController"  "grep -q 'broadcast' backend/src/services/botController.ts"
check "broadcast in positionMonitor" "grep -q 'broadcast' backend/src/services/positionMonitor.ts"
check "broadcast in signalEngine"   "grep -q 'broadcast' backend/src/services/signalEngine.ts"

# Frontend types
check "'bot' in PanelType"          "grep -q '\"bot\"' frontend/src/types/index.ts"
check "bot WsMessage types"         "grep -q 'bot_status_update' frontend/src/types/index.ts"

# botStore
check "botStore.ts exists"          "test -f frontend/src/store/botStore.ts"
check "useBotStore exported"        "grep -q 'export const useBotStore' frontend/src/store/botStore.ts"

# useSocket wiring
check "'bot' channel subscribed"    "grep -q '\"bot\"' frontend/src/hooks/useSocket.ts"
check "subscribedRef.clear() fix"   "grep -q 'subscribedRef.current.clear' frontend/src/hooks/useSocket.ts"
check "bot_status_update handler"   "grep -q 'bot_status_update' frontend/src/hooks/useSocket.ts"

# Dashboard
check "BotPanel in Dashboard"       "grep -q 'BotPanel' frontend/src/pages/Dashboard.tsx"
check "bot-1 in DEFAULT_PANELS"     "grep -q 'bot-1' frontend/src/store/dashboardStore.ts"

# BotPanel component
check "BotPanel.tsx exists"         "test -f frontend/src/components/panels/BotPanel.tsx"
check "Status tab in BotPanel"      "grep -q '\"status\"' frontend/src/components/panels/BotPanel.tsx"
check "Config tab Save button"      "grep -q 'Save Config' frontend/src/components/panels/BotPanel.tsx"
check "PDT counter"                 "grep -q 'pdtResetDay\|dayTradeCount' frontend/src/components/panels/BotPanel.tsx"
check "Emergency STOP button"       "grep -q 'text-red-400\|border-red-600' frontend/src/components/panels/BotPanel.tsx"

echo ""
echo "Results: $PASS passed, $FAIL failed"
[ $FAIL -eq 0 ] && echo "ALL CHECKS PASS" || echo "SOME CHECKS FAILED — fix before marking complete"
```

Run the script:
```bash
bash .planning/phases/05-frontend-bot-dashboard/phase05-checks.sh
```

If any checks fail, fix the underlying issue in the relevant file and re-run until all pass.

Common fixes:
- tsc error: read the error, fix the TypeScript in the file it points to
- Missing grep: the pattern may differ slightly — check the actual file and adjust the route/implementation or the check pattern
- botStore or BotPanel missing: re-run Plan 05-02 or 05-04 tasks
  </action>
  <verify>
    <automated>bash C:/Projects/StockNews/.planning/phases/05-frontend-bot-dashboard/phase05-checks.sh 2>&1 | tail -5</automated>
  </verify>
  <done>Script output ends with "ALL CHECKS PASS". Zero failed checks.</done>
</task>

<task type="checkpoint:human-verify">
  <name>Task 2: Human visual verification of Bot Panel</name>
  <files></files>
  <action>
The automated checks pass. Please review the Bot Panel in your browser.

**To view:**
1. The dashboard at isitabuy.com (or locally if running dev server) should now include a "Bot" panel at the bottom-left of the grid.
2. If running locally: `cd C:/Projects/StockNews/frontend && npm run dev`

**What to verify:**
- [ ] Bot Panel appears in the dashboard grid (may need to scroll down)
- [ ] Four tabs are visible: status, history, signals, config
- [ ] Status tab shows bot state badge (stopped/running/paused), mode (PAPER/LIVE), PDT counter, today's P&L
- [ ] Config tab shows all configuration fields as editable inputs with a Save button
- [ ] Header shows control buttons (START when stopped, PAUSE/STOP when running)
- [ ] Emergency STOP button is red/visually distinct
- [ ] Signals and History tabs show empty state messages when no data exists yet

**Known acceptable states:**
- History and Signals tabs will be empty until the bot has run and produced trades/rejections
- Open positions will be empty if no positions are currently open
- Status may show "stopped" and $0 P&L if bot hasn't been started yet

Confirm below when the panel looks correct. If anything is visually wrong, describe the issue and the plan will be updated.
  </action>
  <verify>Human confirms panel renders correctly with all four tabs navigable and controls visible.</verify>
  <done>User has confirmed Bot Panel renders correctly in the dashboard. Phase 5 is visually verified.</done>
</task>

</tasks>

<verification>
All 24+ automated checks pass. Human confirms Bot Panel renders correctly. tsc --noEmit passes in both frontend and backend.
</verification>

<success_criteria>
- phase05-checks.sh: 0 failures
- Backend tsc: 0 errors
- Frontend tsc: 0 errors
- Human has visually confirmed BotPanel renders with all 4 tabs and correct styling
- All UI-01 through UI-07 requirements are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/05-frontend-bot-dashboard/05-05-SUMMARY.md` using the summary template.

Then update `.planning/STATE.md`:
- current_phase: 05
- current_plan: complete
- status: completed
- progress.completed_phases: 5
- progress.completed_plans: 21 (16 prior + 5 in phase 5)
- stopped_at: Phase 5 complete — Bot Dashboard live
- next action: Phase 6 — Live Trading Mode
</output>
